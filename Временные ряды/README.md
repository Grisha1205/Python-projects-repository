# Прогнозирование заказов такси

## Содержание
1. [Описание проекта](#описание-проекта)
2. [Цель исследования](#цель-исследования)
3. [Критерии исследования](#критерии-исследования)
4. [Исходные данные](#исходные-данные)
5. [Вывод](#вывод)

<a id="описание-проекта"></a>
## Описание проекта

Компания «Чётенькое такси» собрала исторические данные о заказах такси в аэропортах. Чтобы привлекать больше водителей в период пиковой нагрузки, нужно спрогнозировать количество заказов такси на следующий час. Постройте модель для такого предсказания.

<a id="цель-исследования"></a>
## Цель исследования

Построить модель, которая будет прогнозировать количество заказов такси на следующий час.

<a id="критерии-исследования"></a>
## Критерии исследования

Критерии, которые важны заказчику:
* RMSE на тестовой выборке <= 48

<a id="исходные-данные"></a>
## Исходные данные

Данные лежат в файле /datasets/taxi.csv.  

Признаки:
* datetime - время заказа такси

Целевой признак:
* num_orders - число заказов

<a id="вывод"></a>
## Вывод 

**Цель проекта** была достигнута: разработана модель машинного обучения для предсказания количества заказов такси на следующий час.

**1. Анализ и предобработка данных**

Данные в нашем датафрейме указаны с 1 марта 2018 года по 31 августа 2018 года.

Можно выделить такие статистики:
* Среднее количество заказов в час - 84
* Медианное количество заказов в час - 45
* Минимально возможное количество заказов в час - 0
* Максимально возможное количество заказов в час - 462

Чаще всего количество заказов в час составляет 60-100. 

Также в данных имелись значения, превышающие 250 заказов в час. Однако, большинство таких "выбросов" произошло в августе (последний месяц наблюдений), что оказывается не было случайностью. Анализ тренда показал, что каждый месяц среднее количество заказов не быстро, но растет. Поэтому было принято решение "выбросы" не удалять.

**2. Выбор и оценка моделей**

Было 3 кандидата:

* **DummyRegressor**: эту модель использовали, чтобы убедиться, что остальные модели находят закономерности в данных. То есть метрика качества других моделей не должна быть хуже метрики, которую выдает DummyRegressor.
* **LinearRegression**: Выступила в качестве простой и интерпретируемой линейной модели. Ее результаты уступили сложным алгоритмам, что подтвердило наличие нелинейных зависимостей в данных.
* **CatBoostRegressor**: Сложный алгоритм градиентного бустинга, показавший наивысшее качество предсказания. Гиперпараметры были настроены с помощью GridSearchCV, что позволило максимально раскрыть потенциал на предоставленных данных.

**3. Результаты и выбор финальной модели**

Наиболее подходящей оказалась модель **CatBoostRegressor**

Она показала наилучшее качество предсказания с RMSE = 42.3, что удовлетворяет требованию заказчика (RMSE ≤ 48).

Лучшая модель, которая будет рекомендована заказчику:

```python
Pipeline(steps=[('preprocessor',
                 ColumnTransformer(remainder='passthrough',
                                   transformers=[('ohe',
                                                  OneHotEncoder(drop='first',
                                                                handle_unknown='ignore',
                                                                sparse_output=False),
                                                  ['weekday', 'hour']),
                                                 ('num', StandardScaler(),
                                                  ['lag_1', 'lag_2', 'lag_3',
                                                   'lag_4', 'lag_5', 'lag_6',
                                                   'lag_7', 'lag_8', 'lag_9',
                                                   'lag_10', 'lag_11', 'lag_12',
                                                   'lag_13', 'lag_14', 'lag_15',
                                                   'lag_16', 'lag_17', 'lag_18',
                                                   'lag_19', 'lag_20', 'lag_21',
                                                   'lag_22', 'lag_23', 'lag_24',
                                                   'lag_25', 'lag_26', 'lag_27',
                                                   'lag_28', 'lag_29', 'lag_30', ...])])),
                ('model', CatBoostRegressor(iterations=500, 
                                           learning_rate=0.1, 
                                           depth=6, 
                                           random_state=42))])
