# Определение стоимости автомобилей

## Содержание
1. [Описание проекта](#описание-проекта)
2. [Цель исследования](#цель-исследования)
3. [Критерии исследования](#критерии-исследования)
4. [Исходные данные](#исходные-данные)
5. [Вывод](#вывод)

<a id="описание-проекта"></a>
## Описание проекта

Сервис по продаже автомобилей с пробегом «Не бит, не крашен» разрабатывает приложение, чтобы привлечь новых клиентов. В нём можно будет узнать рыночную стоимость своего автомобиля. 
Нужно построить модель, которая научится определять. В нашем распоряжении данные о технических характеристиках, комплектации и ценах других автомобилей.

<a id="цель-исследования"></a>
## Цель исследования

Построить модель, которая научится определять стоимость автомобиля по данным о технических характеристиках и комплектации.

<a id="критерии-исследования"></a>
## Критерии исследования

Критерии, которые важны заказчику:
* качество предсказания;
* время обучения модели;
* время предсказания модели.

<a id="исходные-данные"></a>
## Исходные данные

Данные находятся в файле /datasets/autos.csv. 

Количество заказов находится в столбце 'num_orders' (от англ. number of orders, «число заказов»).

<a id="вывод"></a>
## Вывод

**Цель проекта** была достигнута: разработана модель машинного обучения для предсказания стоимости автомобилей, которая соответствует всем критериям заказчика — качество предсказания, скорость обучения и скорость выполнения предсказаний.

**1. Анализ и предобработка данных**

* Данные были очищены и подготовлены. Были удалены неинформативные признаки.
* Была проведена филтрация данных по цене автомобиля, году регистрации и мощности, что позволило убрать аномалии в данных.
* Был проведен корреляционный анализ, который позволил устранить мультиколлинеарность (удалили признак **brand**)

**2. Выбор и оценка моделей**

Было 4 кандидата:

* **DummyRegressor**: эту модель использовали, чтобы убедиться, что остальные модели находят закономерности в данных. То есть метрика качества других моделей не должна быть хуже метрики, которую выдает DummyRegressor.
* **LinearRegression**: Выступила в качестве простой и интерпретируемой линейной модели. Ее результаты более сложным алгоритмам, что подтвердило наличие нелинейных зависимостей в данных.
* **CatBoostRegressor** и **LightGBMRegressor**: Сложные алгоритмы градиентного бустинга, показавшие наивысшее качество предсказания. Их гиперпараметры были настроены с помощью OptunaSearchCV, что позволило максимально раскрыть их потенциал на предоставленных данных.

**3. Результаты и выбор финальной модели**

Наиболее подходящей оказалась модель **CatBoostRegressor**

Она оказалась самой быстрой в обучении (не берем Dummy модель), быстрой в предсказании новых данных и самой качественной на валидационных данных. 

Модель, которая будет рекомендована заказчику:

```python
<catboost.core.CatBoostRegressor at 0x7f59c19377f0>
{'learning_rate': 0.3413156436410507,
 'iterations': 179,
 'depth': 10,
 'l2_leaf_reg': 3,
 'subsample': 0.7738873722287614,
 'colsample_bylevel': 0.7391026958463592,
 'random_strength': 1.1570949337832006,
 'min_data_in_leaf': 18}
