```python
# Прогнозирование оттока клиентов

## Содержание
1. [Описание проекта](#описание-проекта)
2. [Цель исследования](#цель-исследования)
3. [Критерии исследования](#критерии-исследования)
4. [Исходные данные](#исходные-данные)
5. [Результаты](#результаты)
6. [Рекомендации](#рекомендации)

## Описание проекта

Проект направлен на разработку системы прогнозирования оттока клиентов телекоммуникационной компании. Модель должна идентифицировать клиентов, которые с высокой вероятностью расторгнут договор на обслуживание, что позволит компании предпринять упреждающие меры по их удержанию.

## Цель исследования

Построить модель машинного обучения для прогнозирования оттока клиентов с целевой метрикой ROC-AUC не менее 0.85.

## Критерии исследования
- Основная метрика качества — **ROC-AUC**
- Целевое значение метрики: **не менее 0.85**
- Модель должна обеспечивать высокое качество прогнозирования для своевременного выявления уходящих клиентов

## Исходные данные

Данные представлены в четырех датафреймах:
- `contract_df` — информация о контрактах клиентов
- `personal_df` — персональные данные клиентов
- `internet_df` — данные об интернет-услугах
- `phone_df` — данные о телефонных услугах

## Результаты

### 1. Предобработка данных
- Данные успешно загружены и приведены к корректным типам
- Выполнена обработка пропущенных значений
- Создан целевой признак на основе анализа состояния контрактов

### 2. Исследовательский анализ данных
**Основные выводы о клиентской базе:**
- Среднемесячные расходы клиентов: 35-90 единиц
- Продолжительность контрактов: от 260 до 2314 дней (максимальный срок)
- Преобладает ежемесячная форма оплаты
- Большинство клиентов — не пенсионеры без детей
- Наиболее популярные услуги:
  - Антивирусная защита
  - Блокировка опасных сайтов
  - Выделенная линия поддержки
  - Оптоволоконное подключение

**Портрет клиента с высоким риском оттока:**
1. Не пенсионер
2. Ежемесячная форма оплаты
3. Многолинейная телефонная связь
4. Отсутствие выделенной техподдержки
5. Использование антивируса
6. Облачное хранилище
7. Отсутствие блокировки опасных сайтов
8. Оплата электронными чеками
9. Отсутствие детей
10. Оптоволоконное подключение
11. Средние расходы 60-100 единиц

### 3. Обучение и выбор модели
Протестированы 4 модели:
- `DummyClassifier` (базовая)
- `LogisticRegression`
- `CatBoostClassifier`
- `LightGBMClassifier`

**Лучшая модель:** `CatBoostClassifier` с параметрами:
- subsample: 1.0
- random_strength: 1
- min_data_in_leaf: 5
- learning_rate: 0.3
- l2_leaf_reg: 3
- iterations: 400
- depth: 4
- colsample_bylevel: 1.0

### 4. Оценка качества модели
- **ROC-AUC на тестовых данных: 0.915**
- **Precision: 0.9206** — 92% предсказанных "уходящих" клиентов действительно уйдут
- **Recall: 0.9852** — модель находит 98% реально уходящих клиентов
- **Ключевой признак:** продолжительность контракта в днях

## Рекомендации

1. **Внедрить модель CatBoostClassifier** для идентификации клиентов с риском оттока
2. **Сфокусироваться на клиентах**, соответствующих выявленному портрету уходящего клиента
3. **Разработать программу удержания** с учетом наиболее значимых факторов:
   - Предложить долгосрочные контракты
   - Улучшить услугу технической поддержки
   - Разработать персональные предложения для клиентов с высокими средними расходами
4. **Модель превысила целевую метрику** (0.915 > 0.85) и готова к промышленному внедрению
5. **Рекомендуется периодическое переобучение** модели для поддержания актуальности прогнозов
```
